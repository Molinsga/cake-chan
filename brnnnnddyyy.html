<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday cake ni Christian</title>
    <style>
        body {
            display: flex;
            justify-content: center; 
            align-items: center; 
            height: 100vh;
            margin: 0;
            background-color: #aaaaaa;
            font-family: Arial, sans-serif;
        }

        .cake-container {
            position: relative;
            width: 65%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .cake {
            position: relative;
            width: 250px;
            height: 200px;
        }

        .plate {
            width: 455px;
            height: 110px;
            position: absolute;
            bottom: -25px;
            left: -30px;
            background-color: #ccc;
            border-radius: 50%;
            box-shadow: 0 2px 0 #b3b3b3, 0 4px 0 #b3b3b3, 0 5px 40px rgba(0, 0, 0, 0.5);
        }

        .layer {
            position: absolute;
            display: block;
            width: 400px;
            height: 120px;
            border-radius: 50%;
            background-color: #1e488f; 
            box-shadow: 0 2px 0px #0f2c57, 0 4px 0px #0c2348, 0 6px 0px #0b1f42, 0 8px 0px #0a1c3d, 0 10px 0px #09193a, 0 12px 0px #081739, 0 14px 0px #071538, 0 16px 0px #061237, 0 18px 0px #051036, 0 20px 0px #040e35, 0 22px 0px #030c34, 0 24px 0px #020933, 0 26px 0px #010732, 0 28px 0px #010531, 0 30px 0px #000330;
        }

        .layer-top {
            top: 0px;
        }

        .layer-middle {
            top: 33px;
        }

        .layer-bottom {
            top: 66px;
        }

        .icing {
            position: absolute;
            top: 4px;
            left: 1px;
            background-color: #c0c0c0;
            width: 390px;
            height: 110px;
            border-radius: 50%;
        }

        .icing:before {
            content: "";
            position: absolute;
            top: 1px;
            right: 9px;
            bottom: 4px;
            left: 8px;
            background-color: #c0c0c0;
            box-shadow: 0 0 4px #c0c0c0, 0 0 4px #c0c0c0, 0 0 4px #c0c0c0;
            border-radius: 50%;
            z-index: 1;
        }

        .drip {
            position: absolute;
            background-color: #c0c0c0;
        }

        .drip1 {
            top: 80px;
            left: 5px;
            transform: skewY(33deg);
            height: 70px;
            width: 36px;
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
        }

        .drip2 {
            top: 60px;
            left: 280px;
            transform: skewY(-30deg);
            height: 100px;
            width: 65px;
            border-bottom-left-radius: 25px;
            border-bottom-right-radius: 25px;
        }

        .drip3 {
            top: 90px;
            left: 90px;
            width: 80px;
            height: 60px;
            border-bottom-left-radius: 40px;
            border-bottom-right-radius: 40px;
            background-color: #c0c0c0;
        }

        .drip4 {
            top: 50px;
            left: 341px;
            transform: skewY(25deg);
            width: 50px;
            height: 60px;
            border-bottom-left-radius: 40px;
            border-bottom-right-radius: 40px;
            background-color: #c0c0c0;
        }

        .candle {
            background-color: #1e488f;
            width: 12px;
            height: 50px;
            border-radius: 6px/3px;
            top: 0px;
            left: 70%;
            margin-left: -8px;
            z-index: 10;
            position: absolute;
        }

        .candle:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 12px;
            height: 50px;
            border-radius: 50%;
            background-color: #1e488f;
        }

        .candle.out .flame {
            display: none;
        }

        .flame {
            position: absolute;
            background-color: orange;
            width: 10px;
            height: 25px;
            border-radius: 8px 8px 8px 8px/20px 20px 8px 8px;
            top: -34px;
            left: 50%;
            margin-left: -7.5px;
            z-index: 10;
            box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5);
            transform-origin: 50% 90%;
            animation: flicker 1s ease-in-out alternate infinite;
        }

        @keyframes flicker {
            0% {
                transform: skewX(5deg);
                box-shadow: 0 0 10px rgba(255, 165, 0, 0.2), 0 0 20px rgba(255, 165, 0, 0.2), 0 0 60px rgba(255, 165, 0, 0.2), 0 0 80px rgba(255, 165, 0, 0.2);
            }
            25% {
                transform: skewX(-5deg);
                box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5);
            }
            50% {
                transform: skewX(10deg);
                box-shadow: 0 0 10px rgba(255, 165, 0, 0.3), 0 0 20px rgba(255, 165, 0, 0.3), 0 0 60px rgba(255, 165, 0, 0.3), 0 0 80px rgba(255, 165, 0, 0.3);
            }
            75% {
                transform: skewX(-10deg);
                box-shadow: 0 0 10px rgba(255, 165, 0, 0.4), 0 0 20px rgba(255, 165, 0, 0.4), 0 0 60px rgba(255, 165, 0, 0.4), 0 0 80px rgba(255, 165, 0, 0.4);
            }
            100% {
                transform: skewX(5deg);
                box-shadow: 0 0 10px rgba(255, 165, 0, 0.5), 0 0 20px rgba(255, 165, 0, 0.5), 0 0 60px rgba(255, 165, 0, 0.5), 0 0 80px rgba(255, 165, 0, 0.5);
            }
        }
    </style>
</head>
<body>
    <div class="cake-container">
        <div class="cake" id="cake">
            <div class="plate"></div>
            <div class="layer layer-bottom"></div>
            <div class="layer layer-middle"></div>
            <div class="layer layer-top"></div>
            <div class="icing"></div>
            <div class="drip drip1"></div>
            <div class="drip drip2"></div>
            <div class="drip drip3"></div>
            <div class="drip drip4"></div>
            <div class="candle">
                <div class="flame"></div>
            </div>
        </div>
    </div>

    <audio id="happyBirthdaySong" src="b_m_f_h.mp3" preload="auto"></audio>

    <script>
        function blowCandles() {
            let candles = document.getElementsByClassName('candle');
            for (let candle of candles) {
                candle.classList.add('out'); 
            }
            document.getElementById('happyBirthdaySong').play();
            setTimeout(() => {
                alert('Happy birthday baby! I love you ');
            }, 3000);
        }

        function setupMicrophone() {
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(function(stream) {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const analyser = audioContext.createAnalyser();
                    const microphone = audioContext.createMediaStreamSource(stream);
                    const javascriptNode = audioContext.createScriptProcessor(2048, 1, 1);

                    analyser.smoothingTimeConstant = 0.8;
                    analyser.fftSize = 1024;

                    microphone.connect(analyser);
                    analyser.connect(javascriptNode);
                    javascriptNode.connect(audioContext.destination);

                    javascriptNode.onaudioprocess = function() {
                        const array = new Uint8Array(analyser.frequencyBinCount);
                        analyser.getByteFrequencyData(array);
                        const average = array.reduce((a, b) => a + b) / array.length;

                        if (average > 100) { 
                            blowCandles();
                        }
                    };
                })
                .catch(function(err) {
                    console.error('Error sa pagkuha ng audio: ' + err);
                });
        }

        setupMicrophone();
    </script>
</body>
</html>
